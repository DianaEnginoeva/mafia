using System; using System.Collections.Generic; using System.Collections.ObjectModel; using System.ComponentModel; using System.Runtime.CompilerServices; using System.Threading.Tasks; using System.Windows.Input; using Newtonsoft.Json; using Xamarin.Forms;  namespace Mafia { 	public class StartGameUserViewsModel 	{ 		public ICommand GoOut { get; set; } 		public string RoomName { get; set; } 		private readonly IGameService _gameService; //!! 		public int i = 0;  		public string UserRoom = GameService.Instance._userRoom;  		public ObservableCollection<string> Logs { get; set; } = new ObservableCollection<string> //!!
		{  		};  		private Page _page;  		public StartGameUserViewsModel(Page page, IGameService gameService) //!!
		{ 			_gameService = gameService; //!! 			_gameService.OnReceive += GameService_OnReceive; //!! 			_page = page; 			GoOut = new Command(GoOutCommand); 		}  		public ObservableCollection<RoomModel> Room { get; set; } = new ObservableCollection<RoomModel> 		{ };   		private async void GoOutCommand() 		{ 			GameService.Instance.DelUser(GameService.Instance._userName); 			GameService.Instance.Disconnect(); 			var app = (App)Application.Current; 			app.MainPage = new NavigationPage(new StartingPage()); 		}  		private void GameService_OnReceive(object sender, Message e) //принимает данные сервера
		{ 			Device.BeginInvokeOnMainThread(async () => 			{ 				if ((e.UserMessage == "Game Started") && (i == 0)) 				{ 					i++; 					var app = (App)Application.Current; 					app.MainPage = new NavigationPage(new CardBackPage()); 				} 				if ((e.UserType == "roomdeleted") && (i == 0)) 				{ 					i++; 					var app = (App)Application.Current; 					app.MainPage = new NavigationPage(new StartingPage()); 				} 			});  		} 	} } 